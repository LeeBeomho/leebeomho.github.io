---
layout: single
title: "Strassen"
date: 2020-04-09 18:15:00 +0900
categories: math
use_math: true
---







# 슈트라센 알고리즘



선형대수학에서 슈트라센 알고리즘은 독일의 수학자 폴커 슈트라센이 1969년에 개발한 행렬 곱셈 알고리즘이다. 정의에 따라 n X n 크기의 두 행렬을 곱하면 O(n의 세 제곱)의 시간이 소요되지만 이 알고리즘은 대햑 O(n의 2.807제곱)의 시간이 소요된다.



## 알고리즘

$$
A \ 와 \ B를 \ 체 \ F에 \ 대한 \ 정사각행렬이라고 \ 하자. \ 두 \ 행렬의 \ 곱 \ C는 \ 다음과 \ 같다.
$$



$$
C=AB \ \ \ \ A,B,C \in F^{2^{n} \times 2^{n}}
$$

$$
만약 \ A와 \ B가 \ 2^{n} \times 2^{n} 꼴의 \ 크기가 \ 아니라면 \ 먼저 \ 모자라는 \ 행과 \ 열을 \ 0으로 \ 채운다. \\ 이 \ 경우 \ 행렬 \ 곱셈이 \ 끝난 \ 뒤 \ 행렬에서 \ 필요한 \ 부분만 \ 다시 \ 잘라 \ 내야 \ 한다.
$$


$$
이제 \ A, \ B, \ C를 \ 같은 \ 크기의 \ 정사각행렬 \ 네 \ 개로 \ 나눈다.
$$

$$
A=\begin{bmatrix}
A_{1,1} & A_{1,2} \\
A_{2,1} & A_{2,2} \\
\end{bmatrix}
\ \ \ B=
\begin{bmatrix}
B_{1,1} & B_{1,2} \\
B_{2,1} & B_{2,2} \\
\end{bmatrix}
\ \ \ C=
\begin{bmatrix}
C_{1,1} & C_{1,2} \\
C_{2,1} & C_{2,2} \\
\end{bmatrix}
$$



$$
이 \ 때,
$$

$$
A_{i,j},B_{i,j},C_{i,j} \in F^{2^{n-1} \times 2
^{n-1}}
$$


$$
따라서 \ 다음이 \ 성립한다.
$$

$$
C_{1,1}=A_{1,1}B_{1,1}+A_{1,2}B_{2,1} \\
C_{1,2}=A_{1,1}B_{1,2}+A_{1,2}B_{2,2} \\
C_{2,1}=A_{2,1}B_{1,1}+A_{2,2}B_{2,1} \\
C_{2,2}=A_{2,1}B_{1,2}+A_{2,2}B_{2,2}
$$

$$
이 \ 과정에서는 \ 필요한 \ 연산의 \ 수가 \ 줄어 \ 들지 \ 않는다. \\ 여전히 \ C_{i,j} 행렬을 \ 계산하려면 \ 여덟 \ 번의 \ 곱셈과 \ 네 \ 번의 \ 덧셈이 \ 필요하다.
$$


$$
이제 \ 다음과 \ 같은 \ 행렬을 \ 정의한다.
$$

$$
M_{1}:=(A_{1,1}+A_{2,2})(B_{1,1}+B_{2,2}) \\
M_{2}:=(A_{2,1}+A_{2,2})B_{1,1} \\
M_{3}:=A_{1,1}(B_{1,2}-B_{2,2}) \\
M_{4}:=A_{2,2}(B_{2,1}-B_{1,1}) \\
M_{5}:=(A_{1,1}+A_{1,2})B_{2,2} \\
M_{6}:=(A_{2,1}-A_{1,1})(B_{1,1}+B_{1,2}) \\
M_{7}:=(A_{1,2}-A_{2,2})(B_{2,1}+B_{2,2})
$$



$$
이 \ M_{k}행렬들은 \ C_{i,j}행렬을 \ 표현하는 \ 데 \ 쓰이는 \ 데, \\ 이 \ 행렬들을 \ 계산하는 \ 데는 \ 일곱 \ 번의 \ 곱셈(각 \ 변수마다 \ 한 \ 번씩)과 \ 10번의 \ 덧셈이 \ 필요하다. \\ 이제 \ C_{i,j}행렬은 \ 다음과 \ 같이 \ 표현할 \ 수 \ 있다.
$$

$$
C_{1,1}=M_{1}+M_{4}-M_{5}+M_{7} \\
C_{1,2}=M_{3}+M_{5} \\
C_{2,1}=M_{2}+M_{4} \\
C_{2,2}=M_{1}-M_{2}+M_{3}+M_{6}
$$



$$
이 \ 과정에서는 \ 곱셈이 \ 사용되지 \ 않기 \ 때문에, \\ 전체 \ 곱셈을 \ 일곱 \ 번의 \ 곱셈과 \ 18번의 \ 덧셈으로 \ 처리할 \ 수 \ 있다. \\ 큰 \ 행렬에 \ 대해서는 \ 행렬의 \ 곱셈이 \ 덧셈보다 \ 더 \ 많은 \ 시간을 \ 필요로 \ 하기 \\ 때문에 \ 덧셈을 \ 더 \ 하는 \ 대신 \ 곱셈을 \ 덜 \ 하는 \ 것이 \ 전체적으로 \ 더 \ 효율적이다.
$$

$$
이 \ 과정을 \ 재귀적으로 \ 반복할 \ 경우 \ 총 \ 7  \cdot n^{\log_{2}7}-6 \cdot n^{2}번의 \ 연산이 \ 필요하다.  \\  \log_{2}7=2.807 \cdots 이므로 \ 전체 \ 수행 \ 시간은 \ 약 \ O(n^{2.807})이다.  \\
실제로는 \ n이 \ 작을 \ 경우 \ 정의에 \ 따라 \ 행렬 \ 곱셈을 \ 하는 \ 경우가 \ 빠를 \ 수도 \ 있기 \ 때문에, \\ 보통 \ 작은 \ n에 \ 대해서는 \ 일반적인 \ 방법으로 \ 곱셈을 \ 하도록 \ 구현한다.
$$

$$
슈트라센 \ 알고리즘은 \ 속도에 \ 비해 \ 수치 \ 안전성이 \ 떨어지는 \ 것으로 \ 알려져 \ 있다. \\
두 \ 행렬 \ A와 \ B를 \ 곱한 \ 결과를 \ C라 \ 할 \ 때, \\ 실제 \ 오차인 \ \rVert C-AB \rVert 는 \ 27n^{2}u \rVert A \rVert \rVert B \rVert + O(u^{2})보다 \ 작음이 \ 알려져 \ 있다. \\ 
이는 \ 일반적인 \ 행렬 \ 곱셈보다 \ 더 \ 큰 \ 오차이다.
$$


[위키백과 슈트라센 알곡리즘](https://ko.wikipedia.org/wiki/슈트라센_알고리즘)

고대로 퍼옴



[Minki Kim 블로그](https://mkkim85.github.io/blog-apply-mathjax-to-jekyll-and-github-pages/#mathjax를-통한-수학식-표현의-예)

MathJax 를 Jekyll Github 블로그에 넣어서 LaTeX 사용 하는 법을 알아냄



[위키백과 TeX 문법](https://ko.wikipedia.org/wiki/위키백과:TeX_문법)

적용 후 이 문법으로 수식을 넣음